---
title: "single_gene_test"
output: html_document
date: "2023-08-09"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Comparison of trees

## Load the necessary libraries
```{r message=FALSE}
library(ape)
library(phytools)
library(ggtree)

# Read in the tree files for the single gene and mix models
tree_single <- read.tree(file = "./single_gene_20/one_EOG092C580G.treefile")
tree_mix <- read.tree(file = "./single_gene_20/mix_EOG092C580G.treefile")
```

## Plot the two trees side by side
```{r}
par(mfrow=c(1,2), mar = c(5,1,4,0))
plot(tree_single, main="Tree with single model", cex = 0.85)
plot(tree_mix, main="Tree with mix model",cex = 0.85)
```

## Calculate and compare the cophenetic matrices and tree distances
```{r}
tree_single_coph <- as.data.frame(cophenetic(tree_single))
tree_mix_coph <- as.data.frame(cophenetic(tree_mix))
tree_single_coph <- tree_single_coph[order(rownames(tree_single_coph)), order(colnames(tree_single_coph))]
tree_mix_coph <- tree_mix_coph[order(rownames(tree_mix_coph)), order(colnames(tree_mix_coph))]
branch_diff <- sum((tree_single_coph - tree_mix_coph)^2)
cat("Branch length difference for two trees: ", branch_diff)

rf_distance <- dist.topo(tree_single, tree_mix, method = "PH85")
cat("\nRF distance for two trees: ", rf_distance[[1]])
branch_score <- dist.topo(tree_single, tree_mix, method = "score")
cat("\nBranch length score for two trees: ", branch_score[[1]])

```

## Create a cophylogram of the two trees
```{r}
cophylo.trees <- cophylo(tree_single, tree_mix)
par(mar=c(5.1,1,1.1,1))
plot(cophylo.trees, link.lwd= 1, fsize = 0.7)
```
